#include <iostream>
#include <string>
#include <vector>
#include <random>
using namespace std;

struct Option {
    string description;
    int type;
};

void option_print(Option opts[], int n, int start) {
    for (int i = start; i < n;i++) {
        cout << opts[i].type << ": " << opts[i].description << '\n';
    }
}


class Potion {
private:
    const float relative_zero = 0.001;

    string label_;
    
    vector <string> ingredients_;
    float volume_;
    
    int type_;

    Option bases[8]{
        {"Air", 0},
        {"Water", 1},
        {"Orange juice", 2},
        {"Beer",3},
        {"Unicorn's blood",4},
        {"Abyss",5},
        {"Head of Cerberus",6},
        {"Set of unknown mushrooms",7}
    };
    const int amount_of_bases = sizeof(bases) / sizeof(bases[0]);
    ;
public:
    Potion() { //базовый
        label_ = "Untitled";
        description_ = "Empty bottle.";
        ingredients_.push_back(bases[0].description);
        volume_ = relative_zero;
        price_ = 1;
        type_ = 0;
        cout << "[construct] You took an empty bottle.\n";
    }
    Potion(const Potion& other) { // копирование
        label_ = other.label_;
        description_ = other.description_;
        ingredients_ = other.ingredients_;
        volume_ = other.volume_;
        price_ = other.price_;
        type_ = other.type_;
        cout << "[construct] You brewed exactly the same potion as before.\n";
    }
    Potion(string label, string descriprion, int type_of_base, vector <string> ingredients, float volume, int price) : //полного заполнения
        label_(label), description_(descriprion), ingredients_(ingredients), volume_(volume), price_(price) {
        ingredients_.push_back(bases[type_of_base].description);
        cout << "[construct] You brewed new potion.\n";
    }
    ~Potion() {
        cout << this << "[destruct] Your potion turned sour.";
    }
    Potion operator+ (const Potion& other) {
        if (rand() % 2 == 1) {
            label_ = other.label_;
        }
        if (other.volume_ > volume_) {
            type_ = other.type_;
        }
    }
    Potion operator+= (const Potion& other) {
        if (rand() % 2 == 1) {
            label_ += " с добавлением" + other.label_;
        }
        if (other.volume_ > volume_) {
            type_ = other.type_;
        }
    }

    const string get_label() const { return label_; } // manual value return 
    const string get_description() const { return description_; }
    const float get_volume() const { return volume_; }
    const int get_price() const { return price_; }

    const void print_ingredients() {
        for (int i = 0; i < ingredients_.size(); i++) {
            cout << ingredients_[i] << ' ';
        }
        cout << '\n';
    }
    const void print_base() { // cout included
        if (type_ == 0) {
            cout << "[base] Nothing but an air.\n";
        }
        else {
            cout << "[base] Brewed with " + bases[type_].description + " as basic ingredient.\n";
        }
    }
    const void print_info() {
        cout << get_label() << "\nO: " << get_description() << '\n';
        print_base();
        print_ingredients();
        cout << "V: " << get_volume() << "\nC: " << get_price() << '\n';
    }
protected:
    string description_;
    int price_;
    void set_price(int price) {
        if (price < 0) {
            throw invalid_argument("Price is less than 0.");
        }
        price_ = price;
    }
    void change_base() {
        cout << "Please, choose the basic ingredient:\n";
        option_print(bases, amount_of_bases, 1);
        int t;
        cin >> t;
        if (!(1 <= t <= amount_of_bases)) {
            throw invalid_argument("There're no such a base in our basement.");
        }
        else {
            ingredients_.pop_back();
            ingredients_.push_back(bases[t].description);
            type_ = t;
            volume_ += 0.3;
            cout << "You added " << bases[type_].description << " into your cattle. Now you have different potion.\n";
        }
    }
    void empty_the_glass() {
        if (volume_ <= relative_zero) {
            cout << "The glass is already empty.\n";
        }
        else {
            volume_ = relative_zero;
            type_ = 0;
            price_ = 1;
            description_ = "Empty bottle.";
            cout << "You poured the potion out, only little drops remain.\n";
        }
    }
    void drink() {
        if (volume_ <= relative_zero) {
            cout << "The glass is already empty.\n";
        }
        else {
            volume_ -= 0.1;
            cout << "You open a bottle and make a tiny sip.\n";
        }
    }

};

int main() {

    try {
        Potion N("a", "aaa", 6, { "b","c" }, 0.2, 6);
        Potion D("b", "bbb", 2, { "v","w" }, 0.3, 4);
        N.print_info();
        Potion S = N + D;
    }
    catch (exception ex) {
        cout << ex.what();
    }
}
